<script>
$(document).ready(function () {

    $('#screener').DataTable({
        ajax: function (data, callback, settings) {

            Papa.parse(
                'https://callahan1975.github.io/dividend-screener-simple/data/screener_results.csv',
                {
                    download: true,
                    header: true,
                    skipEmptyLines: true,
                    complete: function (results) {

                        // NormalisÃ©r kolonnenavne
                        const normalizedData = results.data.map(row => {
                            let cleanRow = {};
                            Object.keys(row).forEach(key => {
                                const cleanKey = key.replace(/[^a-zA-Z0-9_]/g, '');
                                cleanRow[cleanKey] = row[key];
                            });
                            return cleanRow;
                        });

                        callback({ data: normalizedData });
                    }
                }
            );
        },

        columns: [
            { data: 'Ticker' },
            { data: 'Name' },
            { data: 'Country' },
            { data: 'Sector' },
            { data: 'Price' },
            { data: 'DividendYield' },
            { data: 'PayoutRatio' },
            { data: 'PE' }
        ],

        pageLength: 25,
        order: [[0, 'asc']],
        deferRender: true
    });

});
</script>
