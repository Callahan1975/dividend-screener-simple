<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Dividend Screener – Baseline</title>

  <!-- DataTables CSS -->
  <link
    rel="stylesheet"
    href="https://cdn.datatables.net/1.13.8/css/jquery.dataTables.min.css"
  />

  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
        Roboto, Helvetica, Arial, sans-serif;
      margin: 30px;
    }

    h1 {
      margin-bottom: 10px;
    }

    table.dataTable tbody td {
      vertical-align: middle;
    }

    .num {
      text-align: right;
    }

    .muted {
      color: #999;
    }
  </style>
</head>

<body>
  <h1>Dividend Screener – Baseline</h1>

  <table id="screener" class="display" style="width: 100%">
    <thead>
      <tr>
        <th>Ticker</th>
        <th>Name</th>
        <th>Country</th>
        <th>Sector</th>
        <th class="num">Price</th>
        <th class="num">Dividend Yield</th>
        <th class="num">Payout Ratio</th>
        <th class="num">PE</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

  <!-- DataTables -->
  <script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>

  <!-- PapaParse (CSV) -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <script>
    function fmtNumber(v) {
      if (v === null || v === undefined || v === "") return "–";
      const n = Number(v);
      return isNaN(n) ? "–" : n.toFixed(2);
    }

    function fmtPercent(v) {
      if (v === null || v === undefined || v === "") return "–";
      const n = Number(v);
      return isNaN(n) ? "–" : n.toFixed(2) + " %";
    }

    fetch("data/screener_results.csv")
      .then((r) => r.text())
      .then((csv) => {
        const parsed = Papa.parse(csv, {
          header: true,
          skipEmptyLines: true,
        });

        const data = parsed.data;

        $("#screener").DataTable({
          data: data,

          columns: [
            { data: "Ticker" },
            { data: "Name" },
            { data: "Country" },
            { data: "Sector" },
            {
              data: "Price",
              className: "num",
              render: (d) => fmtNumber(d),
            },
            {
              data: "DividendYield_%",
              className: "num",
              render: (d) => fmtPercent(d),
            },
            {
              data: "PayoutRatio_%",
              className: "num",
              render: (d) => fmtPercent(d),
            },
            {
              data: "PE",
              className: "num",
              render: (d) => fmtNumber(d),
            },
          ],

          pageLength: 25,
          order: [[0, "asc"]],
          deferRender: true,
          autoWidth: false,
        });
      });
  </script>
</body>
</html>
