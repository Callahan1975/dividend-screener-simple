<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dividend Screener – DGI</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="https://cdn.datatables.net/1.13.8/css/jquery.dataTables.min.css">

<style>
body{
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;
  margin:32px;
}
.filters select{
  margin-right:10px;
  padding:6px 8px;
}
.signal-BUY{color:#1a7f37;font-weight:700}
.signal-HOLD{color:#b8860b;font-weight:700}
.signal-AVOID{color:#b42318;font-weight:700}
table.dataTable thead th{white-space:nowrap}
</style>
</head>

<body>

<h1>Dividend Screener – DGI</h1>
<p id="generated"></p>

<div class="filters">
  <select id="fClass">
    <option value="">All Classes</option>
    <option value="King">King</option>
    <option value="Aristocrat">Aristocrat</option>
    <option value="Contender">Contender</option>
  </select>

  <select id="fRegion">
    <option value="">All Regions</option>
    <option value="US">US</option>
    <option value="DK">DK</option>
    <option value="SE">SE</option>
    <option value="NL">NL</option>
    <option value="CA">CA</option>
  </select>

  <select id="fSignal">
    <option value="">All Signals</option>
    <option value="BUY">BUY</option>
    <option value="HOLD">HOLD</option>
    <option value="AVOID">AVOID</option>
  </select>
</div>

<table id="tbl" class="display" style="width:100%">
<thead>
<tr>
  <th>Ticker</th>
  <th>Name</th>
  <th>Region</th>
  <th>Dividend Class</th>
  <th>Dividend Yield</th>
  <th>Div CAGR 3Y</th>
  <th>Div CAGR 5Y</th>
  <th>Payout Ratio</th>
  <th>Confidence</th>
  <th>Signal</th>
</tr>
</thead>
</table>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<script>
Papa.parse("data/screener_results/screener_results.csv", {
  download:true,
  header:true,
  skipEmptyLines:true,
  complete: function(res){

    const rows = res.data.filter(r => r.Ticker);

    if(rows.length){
      document.getElementById("generated").textContent =
        "GeneratedUTC: " + rows[0].GeneratedUTC;
    }

    const table = $('#tbl').DataTable({
      data: rows,
      pageLength: 25,
      order: [[8,"desc"],[6,"desc"],[4,"desc"]],
      columns: [
        {data:"Ticker"},
        {data:"Name"},
        {data:"Region"},
        {data:"DividendClass"},
        {data:"DividendYield"},
        {data:"DivCAGR_3Y"},
        {data:"DivCAGR_5Y"},
        {data:"PayoutRatio"},
        {data:"Confidence"},
        {
          data:"Signal",
          render: v => v ? `<span class="signal-${v}">${v}</span>` : ""
        }
      ]
    });

    $('#fClass').on('change', function(){
      table.column(3).search(this.value).draw();
    });
    $('#fRegion').on('change', function(){
      table.column(2).search(this.value).draw();
    });
    $('#fSignal').on('change', function(){
      table.column(9).search(this.value).draw();
    });
  }
});
</script>

</body>
</html>
