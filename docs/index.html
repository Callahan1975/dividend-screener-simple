<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dividend Screener – Decision View</title>

<link rel="stylesheet" href="https://cdn.datatables.net/1.13.8/css/jquery.dataTables.min.css">
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<style>
body { font-family: system-ui; margin: 20px; }
.badge { padding:4px 8px; border-radius:6px; font-size:12px; }
.buy { background:#d1fae5; }
.hold { background:#e0f2fe; }
.watch { background:#fee2e2; }
.high { background:#bbf7d0; }
.medium { background:#fde68a; }
.low { background:#fecaca; }
</style>
</head>

<body>
<h2>Dividend Screener – Decision View</h2>
<p>Live data from <code>data/screener_results/screener_results.csv</code></p>

<table id="tbl" class="display" style="width:100%">
<thead>
<tr>
<th>Ticker</th>
<th>Name</th>
<th>Country</th>
<th>Sector</th>
<th>Currency</th>
<th>Price</th>
<th>Yield %</th>
<th>Payout %</th>
<th>PE</th>
<th>Score</th>
<th>Signal</th>
<th>Conf</th>
<th>Why</th>
</tr>
</thead>
</table>

<script>
$(document).ready(function () {

  Papa.parse('data/screener_results/screener_results.csv', {
    download: true,
    header: true,
    dynamicTyping: true,
    skipEmptyLines: true,
    complete: function(results) {

      $('#tbl').DataTable({
        data: results.data,
        columns: [
          { data: 'Ticker' },
          { data: 'Name' },
          { data: 'Country' },
          { data: 'Sector' },
          { data: 'Currency' },
          { data: 'Price' },
          { data: 'DividendYield_%' },
          { data: 'PayoutRatio_%' },
          { data: 'PE' },
          { data: 'Score' },
          {
            data: 'Signal',
            render: d => d ? `<span class="badge ${d.toLowerCase()}">${d}</span>` : ''
          },
          {
            data: 'Conf',
            render: d => d ? `<span class="badge ${d.toLowerCase()}">${d}</span>` : ''
          },
          { data: 'Why' }
        ],
        order: [[9, 'desc']],
        pageLength: 25,
        deferRender: true
      });

    }
  });

});
</script>
</body>
</html>
