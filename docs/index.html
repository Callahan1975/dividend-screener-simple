<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Dividend Screener – Decision View</title>

  <link rel="stylesheet"
        href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">

  <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>

  <style>
    body { font-family: system-ui; margin: 20px; }
    .badge { padding: 3px 8px; border-radius: 10px; font-size: 12px; }
    .GOLD { background:#ffd700; }
    .BUY { background:#c8f7c5; }
    .HOLD { background:#eee; }
    .WATCH { background:#ffd6d6; }
    .High { background:#c8f7c5; }
    .Medium { background:#ffe9a8; }
    .Low { background:#ffd6d6; }
  </style>
</head>

<body>
<h2>Dividend Screener – Decision View</h2>

<table id="tbl" class="display" style="width:100%">
  <thead>
    <tr>
      <th>Ticker</th>
      <th>Name</th>
      <th>Country</th>
      <th>Sector</th>
      <th>Currency</th>
      <th>Price</th>
      <th>Yield %</th>
      <th>Payout %</th>
      <th>PE</th>
      <th>Score</th>
      <th>Signal</th>
      <th>Conf</th>
      <th>Why</th>
    </tr>
  </thead>
</table>

<script>
$(document).ready(function () {
  $('#tbl').DataTable({
    ajax: {
      url: 'data/screener_results/screener_decision.csv',
      dataType: 'text',
      dataSrc: function (csv) {
        const rows = csv.split('\n').slice(1);
        return rows.map(r => {
          const c = r.split(',');
          return {
            Ticker: c[0],
            Name: c[1],
            Country: c[2],
            Sector: c[5],
            Currency: c[3],
            Price: c[8],
            Yield: c[9],
            Payout: c[10],
            PE: c[11],
            Score: c[c.length-4],
            Signal: c[c.length-3],
            Conf: c[c.length-2],
            Why: c[c.length-1]
          };
        });
      }
    },
    columns: [
      {data:'Ticker'},
      {data:'Name'},
      {data:'Country'},
      {data:'Sector'},
      {data:'Currency'},
      {data:'Price'},
      {data:'Yield'},
      {data:'Payout'},
      {data:'PE'},
      {data:'Score'},
      {
        data:'Signal',
        render:d=>`<span class="badge ${d}">${d}</span>`
      },
      {
        data:'Conf',
        render:d=>`<span class="badge ${d}">${d}</span>`
      },
      {data:'Why'}
    ],
    order:[[9,'desc']]
  });
});
</script>
</body>
</html>
